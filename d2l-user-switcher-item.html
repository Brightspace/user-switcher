<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-icons/d2l-icons.html">
<link rel="import" href="../d2l-menu/d2l-menu-item-behavior.html">
<link rel="import" href="../d2l-menu/d2l-menu-item-styles.html">
<link rel="import" href="../d2l-colors/d2l-colors.html">
<link rel="import" href="../d2l-user-profile-behavior/d2l-user-profile-behavior.html">
<link rel="import" href="../d2l-image/d2l-image.html">
<link rel="import" href="icons.html">

<dom-module id="d2l-user-switcher-item">
	<template>
		<style include="d2l-menu-item-styles">
			.d2l-user-switcher-item-link {
				text-decoration: none;
			}
			.d2l-user-switcher-item-container {
				display: flex;
				flex-direction: row;
				align-items: center;
				margin: 10px 30px;
			}
			.d2l-user-switcher-item-image {
				max-width: 42px;
				max-height: 42px;
				margin-right: 15px;
				border-radius: 6px;
				overflow: hidden;
			}
			 :host-context([dir="rtl"]) .d2l-user-switcher-item-image {
				margin-right: 0;
				margin-left: 15px;
			}
			.d2l-user-switcher-item-info {
				display: flex;
				flex-direction: column;
				align-items: left;
			}
			.d2l-user-switcher-item-name {
				margin: 0;
				font-size: 19px;
				line-height: 24px;
				font-weight: normal;
				color: var(--d2l-color-celestine);
			}
			.user-tile-default-icon {
				--d2l-icon-height: 100%;
				--d2l-icon-width: 100%;
			}
			[hidden] {
				display: none;
			}
		</style>


		<a href="javascript:void(0);" class="d2l-user-switcher-item-link d2l-user-switcher-item-container" tabindex="-1">
			<d2l-icon
				hidden$="[[_hidePlaceholderIcon(_iconUrl)]]"
				icon="d2l-tier3:profile-pic"
				class="user-tile-default-icon d2l-user-switcher-item-image">
			</d2l-icon>
			<d2l-image
				hidden$="[[!_hidePlaceholderIcon(_iconUrl)]]"
				image-url="[[_iconUrl]]"
				token="[[token]]"
				class="d2l-user-switcher-item-image">
			</d2l-image>
			<div class="d2l-user-switcher-item-info">
				<p class="d2l-user-switcher-item-name">[[_name]]</p>
			</div>
		</a>
	</template>
	<script src="https://s.brightspace.com/lib/ifrau/0.19.0/ifrau/client.js"></script>
	<script>
		'use strict';

		Polymer({
			is: 'd2l-user-switcher-item',

			properties: {
				token: {
					type: String,
					value: null
				},
				userUrl: {
					type: String,
					value: null
				},
				_iconUrl: {
					type: String,
					value: null
				}
			},

			behaviors: [
				window.D2L.PolymerBehaviors.MenuItemBehavior,
				window.D2L.UserProfileBehavior
			],

			observers: [
				'_onUserChange( userUrl, token )'
			],

			_onUserChange: function(userUrl, token) {
				if (userUrl && token) {
					this.generateUserRequest(userUrl, token);
				}
			},

			_hidePlaceholderIcon: function(icon) {
				return !!icon;
			}
		});
	</script>
</dom-module>
